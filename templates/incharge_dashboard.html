{% extends "base.html" %}
{% block content %}
<div class="dashboard-head">
  <div>
    <h2>In-Charge Dashboard</h2>
    <p class="muted">Handle pending requests and track today's student movement quickly.</p>
  </div>
  <a href="{{ url_for('incharge.logs') }}" class="btn">View Scan Logs</a>
</div>

<div class="grid-two" style="margin-top:12px;">
  <div class="panel">
    <h3 class="panel-title">Pending Approvals</h3>
    <table>
      <tr>
        <th>ID</th>
        <th>Student</th>
        <th>Reason</th>
        <th>Requested</th>
        <th>Action</th>
      </tr>

      {% for p in passes %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.student.name }}</td>
        <td>{{ p.reason }}</td>
        <td>{{ p.date_requested|dt_short }}</td>
        <td><a href="{{ url_for('incharge.view_request', pass_id=p.id) }}">Review</a></td>
      </tr>
      {% endfor %}
    </table>
  </div>

  <div class="panel">
    <h3 class="panel-title">Students Requested Today</h3>
    <table>
      <tr>
        <th>Student</th>
        <th>Department</th>
        <th>Status</th>
      </tr>
      {% for p in today_requests %}
      <tr>
        <td>{{ p.student.name }}</td>
        <td>{{ p.student.department or '-' }}</td>
        <td>{{ p.status }}</td>
      </tr>
      {% endfor %}
    </table>

    <h3 class="panel-title" style="margin-top:14px;">Currently Outside (Today)</h3>
    <table>
      <tr>
        <th>Student</th>
        <th>Out Time</th>
      </tr>
      {% for p in present_today %}
      <tr>
        <td>{{ p.student.name }}</td>
        <td>{{ p.exit_time|dt_short }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>


{% endblock %}
